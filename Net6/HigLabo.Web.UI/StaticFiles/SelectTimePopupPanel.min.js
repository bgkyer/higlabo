import{DateTime as t}from"./DateTime.js";import{$ as n}from"./HtmlElementQuery.js";var i=function(){function i(){this._funcList=[];this.selectDuration=!1;this.selectEndTime=!1;this.panel=document.getElementById("SelectTimePopupPanel");this._durationPanel=document.getElementById("SelectDurationPopupPanel");this._endTimePanel=document.getElementById("SelectEndTimePopupPanel")}return i.prototype.initialize=function(){n(document).on("click","input[time-picker]",this.textBox_Click.bind(this));n("input[time-picker]").keydown(this.textBox_Keydown.bind(this));n("#SelectTimePopupPanelShowAllChekBox").change(this.showAllChekBox_Change.bind(this));n(this.panel).on("click","[minute-panel]",this.minutePanel_Click.bind(this));n(this.panel).on("dblclick","[minute-panel]",this.minutePanel_DoubleClick.bind(this));n(this._durationPanel).on("click","[duration-minute]",this.durationMinutePanel_Click.bind(this));n(this._endTimePanel).on("click","[minute-panel]",this.endTimeMinutePanel_Click.bind(this))},i.prototype.textBox_Click=function(n){var t=n;t!=null&&(this.textBox=t,this.show(this.textBox))},i.prototype.textBox_Keydown=function(){this.hide()},i.prototype.showAllChekBox_Change=function(){var t=n("#SelectTimePopupPanelShowAllChekBox");t.isChecked()?(n(this.panel).setAttribute("display-all","true"),n(this._endTimePanel).setAttribute("display-all","true")):(n(this.panel).setAttribute("display-all","false"),n(this._endTimePanel).setAttribute("display-all","false"))},i.prototype.minutePanel_Click=function(n,t){this.setTextBoxValue(n);this.isDisplayNextPopupPanel(n);t.stopPropagation()},i.prototype.minutePanel_DoubleClick=function(n,t){this.setTextBoxValue(n);this.hide();t.stopPropagation()},i.prototype.setTextBoxValue=function(t){var i=n(t),r=i.getAttribute("hour"),u=i.getAttribute("minute");this.textBox!=null&&(n(this.textBox).setValue(r+":"+u),this.startTime=n(this.textBox).getValue());this.executeFunction()},i.prototype.executeFunction=function(){for(var t,n=0;n<this._funcList.length;n++)t=this._funcList[n],t(this,{})},i.prototype.isDisplayNextPopupPanel=function(t){var r=n(t).getParent("tr").getFirstElement(),i=r.getBoundingClientRect();this.selectDuration==!0?(n(this._durationPanel).setStyle("display","block"),n(this._durationPanel).setStyle("left",i.left+i.width+"px"),n(this._durationPanel).setStyle("top",i.top+"px"),this.ensureInsideWindow(this._durationPanel)):this.selectEndTime==!0?(n(this._endTimePanel).setStyle("display","block"),n(this._endTimePanel).setStyle("left",i.left+i.width+"px"),n(this._endTimePanel).setStyle("top",i.top+"px"),this.ensureInsideWindow(this._endTimePanel)):(this.textBox=null,this.hide())},i.prototype.durationMinutePanel_Click=function(i,r){var u=n(i),f=parseInt(u.getAttribute("minute")),e=new t("2000/1/1 "+n(this.textBox).getValue()),o=e.addMinute(f);n(this.endTimeTextBox).setValue(o.toString("hh:mm"));this.endTime=n(this.endTimeTextBox).getValue();this.textBox=null;this.endTimeTextBox=null;this.hide();r.stopPropagation()},i.prototype.endTimeMinutePanel_Click=function(t,i){var r=n(t),u=r.getAttribute("hour"),f=r.getAttribute("minute");n(this.endTimeTextBox).setValue(u+":"+f);this.endTime=n(this.endTimeTextBox).getValue();this.textBox=null;this.endTimeTextBox=null;this.hide();i.stopPropagation()},i.prototype.show=function(t){this.selectDuration=!1;this.selectEndTime=!1;n(this.textBox).getAttribute("select-duration")=="true"&&(this.selectDuration=!0);n(this.textBox).getAttribute("select-end-time")=="true"&&(this.selectEndTime=!0);this.endTimeTextBox=n(this.textBox).getNearestElement("[time-picker]");var i=this.panel,r=n(t).getOffset(),u=r.top+n(t).getOuterHeight();n(i).setStyle("left",r.left+"px");n(i).setStyle("top",u+"px");n(i).setStyle("display","initial");this.ensureInsideWindow(i,t)},i.prototype.ensureInsideWindow=function(t,i){var r=n(t),h=r.getOffset(),u=h.left,e=h.top,c=window.innerWidth,o=window.innerHeight+n(window).getScrollTop()-24,l=r.getOuterWidth(),s=r.getOuterHeight(),f;u+l>c-10?(u=c-l-10,r.setStyle("left",u+"px")):(u<0&&(u=0),r.setStyle("left",u+"px"));i==null?e+s>o?(f=o-s,f>0?r.setStyle("top",f+"px"):r.setStyle("top",o-r.getOuterHeight()+"px")):r.setStyle("top",e+"px"):e+s>o?(f=e-r.getInnerHeight()-n(i).getOuterHeight()-2,f>0?r.setStyle("top",f+"px"):r.setStyle("top",o-r.getOuterHeight()+"px")):r.setStyle("top",e+"px")},i.prototype.hide=function(){n(this.panel).hide();n(this._durationPanel).hide();n(this._endTimePanel).hide()},i.prototype.changed=function(n){this._funcList.push(n)},i}();export default i;